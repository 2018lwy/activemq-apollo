---
# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to You under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

title: TODO
in_menu: true
--- name:overview pipeline:haml,tags

%h1 The TODO list

Stuff that still needs to get done.  Contributions Welcomed!

--- name:content pipeline:textile

h2. Transactions:

* Should be backed by cursored queue

h2. Large Message Support:

* There are some stubs in the Store interface for this, but basically for large messages we should be able to stage them to disk, and when given to a consumer chunk the payload out to keep memory low. The cursored queue will need to be updated to handle this.

h2. Protocol Support

Lots of work still to be done here\!

* Protocol Handlers are there for OpenWire and STOMP, and we'll want to add proto buf as well.
* Do we convert things to a common message format on arrival or keep them in their native format doing transforms on the fly?
* Common interfaces for Connection/Session/*Consumer for the broker to interact with?
* Threading model ... We should probably come up with a good abstract base class for the protocol handlers that helps to provide a threading model that will make synchronization between I/O events (exceptions etc), protocol events and message dispatch). 

h2. Replication:

* This should be handled by KahaDB replication
* Still need to think about replication of non persistent messages, though ...e.g. messages that are never saved to disk but only replicated to peers.
* Recovery time. Keep state fairly hot to achieve fast failover time, we'll want to keep optimizations in this area in mind (basically messages that are in memory on the active broker are kept in memory on the standby as well).

h2. General Interface cleanliness

A fair amount of clean up work needs to be done to clean up and harden interfaces in the prototype. 

h2. Testing

As much of the work to date has been largely experimental in nature, testing up to now has focussed mainly on end to end type performance tests, but more unit testing and functional testing of edge cases such as slow subscriber test etc are needed. 

h1. Misc Tasks

* InactivityMonitor needs to get inserted for OpenWire on the server side of MultiWireFormat negotiation.
* BIO SSL Transport does not currently pass Client Certificate chain in OpenWire ConnectionInfo command. This used to be done by the SSL transport but this shouldn't have OpenWire dependencies; instead protocol handler should be able to retrieve it from the underlying transport as needed. 



